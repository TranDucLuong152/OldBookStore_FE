<div class="background_cart  d-flex justify-content-center">

    <div class="m-auto">
        <h2 class="text-light ms-3">Quản lý</h2>
        <div class="d-flex ">
            <a class="text-color text-decoration-none" href="#">Trang chủ </a>
            <p class="ps-3 pe-3 text-color ">/</p>
            <a class="text-color text-decoration-none">Quản lý</a>

        </div>
    </div>

</div>
<div class="d-flex">
    <div class="d-flex flex-column flex-shrink-0 p-3 bg-body-tertiary rounded shadow" style="width: 300px;">

        <span class="fs-4 text-center">QUẢN LÝ</span>

        <hr>
        <ul class="" id="myTab" role="tablist">

            <button class="btn btn-primary col-12 m-1 active" id="home-tab" data-bs-toggle="tab"
                data-bs-target="#home-tab-pane" type="button" role="tab" aria-controls="home-tab-pane"
                aria-selected="true">Sản phẩm</button>


            <button class="btn btn-primary col-12 m-1" id="profile-tab" data-bs-toggle="tab"
                data-bs-target="#profile-tab-pane" type="button" role="tab" aria-controls="profile-tab-pane"
                aria-selected="false">Người dùng</button>

            <button class="btn btn-primary col-12 m-1" id="profile-tab" data-bs-toggle="tab"
                data-bs-target="#product-tab-pane" type="button" role="tab" aria-controls="product-tab-pane"
                aria-selected="false">Thống kê sản phẩm</button>
            <button class="btn btn-primary col-12 m-1" id="contact-tab" data-bs-toggle="tab"
                data-bs-target="#contact-tab-pane" type="button" role="tab" aria-controls="contact-tab-pane"
                aria-selected="false">Thống kê người dùng</button>

        </ul>

        <hr>

    </div>
    <div class="tab-content col" id="myTabContent">
        <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab"
            tabindex="0">
            <form [formGroup]="bookForm" class="m-5">
                <div class="mb-3">
                    <label for="id" class="form-label">ID</label>
                    <input type="text" class="form-control" placeholder="ID" formControlName="bookId">

                    <label for="title" class="form-label">Tiêu đề</label>
                    <input formControlName="title" type="text" class="form-control" placeholder="Tiêu đề">
                    <div *ngIf="bookForm.get('title')?.invalid && bookForm.get('title')?.touched" class="text-danger">
                        <small *ngIf="bookForm.get('title')?.errors?.['required']">Tiêu đề là bắt buộc.</small>
                    </div>

                    <label for="price" class="form-label">Giá</label>
                    <input formControlName="price" type="number" class="form-control" placeholder="Giá">
                    <div *ngIf="bookForm.get('price')?.invalid && bookForm.get('price')?.touched" class="text-danger">
                        <small *ngIf="bookForm.get('price')?.errors?.['pattern']">Giá phải là số hợp lệ với tối đa hai
                            chữ số thập phân.</small>
                        <small *ngIf="bookForm.get('price')?.errors?.['required']">Giá là bắt buộc.</small>
                    </div>

                    <label for="stockQuantity" class="form-label">Số lượng</label>
                    <input formControlName="stockQuantity" type="number" class="form-control" placeholder="Số lượng">
                    <div *ngIf="bookForm.get('stockQuantity')?.invalid && bookForm.get('stockQuantity')?.touched"
                        class="text-danger">
                        <small *ngIf="bookForm.get('stockQuantity')?.errors?.['pattern']">Số lượng phải là số nguyên
                            dương.</small>
                        <small *ngIf="bookForm.get('stockQuantity')?.errors?.['required']">Số lượng là bắt buộc.</small>
                    </div>

                    <label for="publicationDate" class="form-label">Ngày bán</label>
                    <input formControlName="publicationDate" type="date" class="form-control">
                    <div *ngIf="bookForm.get('publicationDate')?.invalid && bookForm.get('publicationDate')?.touched"
                        class="text-danger">
                        <small *ngIf="bookForm.get('publicationDate')?.errors?.['pattern']">Ngày bán không hợp
                            lệ.</small>
                        <small *ngIf="bookForm.get('publicationDate')?.errors?.['required']">Ngày bán là bắt
                            buộc.</small>
                    </div>

                    <label for="coverImage" class="form-label">Ảnh</label>
                    <input (change)="handleFileInputBook($event)" type="file" class="form-control">
                    <div *ngIf="bookForm.get('coverImage')?.invalid && bookForm.get('coverImage')?.touched"
                        class="text-danger">
                        <small *ngIf="bookForm.get('coverImage')?.errors?.['pattern']">Ảnh không hợp lệ.</small>
                        <small *ngIf="bookForm.get('coverImage')?.errors?.['required']">Ảnh là bắt buộc.</small>
                    </div>

                    <label for="categoryId" class="form-label">Loại sách</label>
                    <select formControlName="categoryId" class="form-control">
                        <option value="">Chọn loại sách</option>
                        <option *ngFor="let category of categories" [value]="category.categoryId">{{ category.name }}
                        </option>
                    </select>
                    <div *ngIf="bookForm.get('categoryId')?.invalid && bookForm.get('categoryId')?.touched"
                        class="text-danger">
                        <small *ngIf="bookForm.get('categoryId')?.errors?.['required']">Loại sách là bắt buộc.</small>
                    </div>

                    <label for="description" class="form-label">Mô tả</label>
                    <textarea formControlName="description" class="form-control" placeholder="Mô tả"></textarea>
                </div>
                <small>{{message}}</small>
                <div class="d-flex justify-content-evenly">
                    <button type="button" (click)="addProduct()" class="btn btn-primary">Thêm</button>
                    <button type="button" (click)="updateProduct()" class="btn btn-warning">Sửa</button>
                    <button type="button" (click)="resetFormBook()" class="btn btn-secondary">Làm mới</button>
                    <button type="button" (click)="deleteProduct()" class="btn btn-danger">Xóa</button>
                </div>
            </form>


        </div>
        <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
            <form [formGroup]="userForm" class="m-5" (ngSubmit)="registerUser()">
                <div class="mb-3">
                    <label for="username" class="form-label">Tên Tài khoản</label>
                    <input formControlName="username" type="text" class="form-control" placeholder="Tên Tài khoản">
                    <div *ngIf="userForm.get('username')?.invalid && userForm.get('username')?.touched"
                        class="text-danger">
                        <small *ngIf="userForm.get('username')?.errors?.['required']">Tên Tài khoản là bắt buộc.</small>
                    </div>

                    <label for="password" class="form-label">Mật khẩu</label>
                    <input formControlName="password" type="password" class="form-control" placeholder="Mật khẩu">
                    <div *ngIf="userForm.get('password')?.invalid && userForm.get('password')?.touched"
                        class="text-danger">
                        <small *ngIf="userForm.get('password')?.errors?.['required']">Mật khẩu là bắt buộc.</small>
                    </div>

                    <label for="fullName" class="form-label">Họ tên</label>
                    <input formControlName="fullName" type="text" class="form-control" placeholder="Họ tên">
                    <div *ngIf="userForm.get('fullName')?.invalid && userForm.get('fullName')?.touched"
                        class="text-danger">
                        <small *ngIf="userForm.get('fullName')?.errors?.['required']">Họ tên là bắt buộc.</small>
                    </div>

                    <label for="address" class="form-label">Địa chỉ</label>
                    <input formControlName="address" type="text" class="form-control" placeholder="Địa chỉ">
                    <div *ngIf="userForm.get('address')?.invalid && userForm.get('address')?.touched"
                        class="text-danger">
                        <small *ngIf="userForm.get('address')?.errors?.['required']">Địa chỉ là bắt buộc.</small>
                    </div>

                    <label for="email" class="form-label">Email</label>
                    <input formControlName="email" type="email" class="form-control" placeholder="Email">
                    <div *ngIf="userForm.get('email')?.invalid && userForm.get('email')?.touched" class="text-danger">
                        <small *ngIf="userForm.get('email')?.errors?.['required']">Email là bắt buộc.</small>
                        <small *ngIf="userForm.get('email')?.errors?.['email']">Email không hợp lệ.</small>
                    </div>

                    <label for="phoneNumber" class="form-label">Số điện thoại</label>
                    <input formControlName="phoneNumber" type="text" class="form-control" placeholder="Số điện thoại">
                    <div *ngIf="userForm.get('phoneNumber')?.invalid && userForm.get('phoneNumber')?.touched"
                        class="text-danger">

                        <small *ngIf="userForm.get('phoneNumber')?.errors?.['pattern']">Số điện không hợp lệ.</small>
                        <small *ngIf="userForm.get('phoneNumber')?.errors?.['required']">Số điện thoại là bắt
                            buộc.</small>
                    </div>

                    <label for="role" class="form-label">Quyền</label>
                    <select formControlName="role" class="form-control">
                        <option [ngValue]="true">Admin</option>
                        <option [ngValue]="false">User</option>
                    </select>
                    <div *ngIf="userForm.get('role')?.invalid && userForm.get('role')?.touched" class="text-danger">
                        <small *ngIf="userForm.get('role')?.errors?.['required']">Quyền là bắt buộc.</small>
                    </div>
                </div>

                <div class="d-flex justify-content-evenly">
                    <button type="submit" class="btn btn-primary">Thêm</button>
                    <button type="button" (click)="updateUser()" class="btn btn-warning">Sửa</button>
                    <button type="button" (click)="resetFormUser()" class="btn btn-secondary">Làm mới</button>
                    <button type="button" (click)="deleteUser()" class="btn btn-danger">Xóa</button>
                </div>
            </form>


        </div>
        <div class="tab-pane fade" id="product-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
            <div class=" m-5">
                <table class="table table-striped table-sm">
                    <thead>
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Hình ảnh</th>
                            <th scope="col">Tên sách</th>
                            <th scope="col">Giá sách</th>
                            <th scope="col">Số lượng</th>
                            <th scope="col">Ngày bán</th>
                            <th scope="col">Mô tả</th>
                            <th scope="col">Chỉnh sửa</th>
                            <th scope="col">Xóa</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of books ">
                            <td width="10%">{{item.bookId}}</td>
                            <td width="10%">{{item.coverImage}}</td>
                            <td width="10%">{{item.title}}</td>
                            <td width="10%">{{item.price}}</td>
                            <td width="10%">{{item.stockQuantity}}</td>
                            <td width="10%">{{item.publicationDate}}</td>
                            <td width="10%" class="truncate">{{item.description}}</td>
                            <td width="10%"><button class="btn" (click)="editBook(item)" data-bs-target="#home-tab-pane"
                                    aria-controls="home-tab-pane" aria-selected="true">Chỉnh sửa</button></td>
                            <td width="10%"><button class="btn btn-danger"
                                    (click)="deleteBook(item.bookId)">Xóa</button></td>

                        </tr>
                    </tbody>

                </table>
            </div>


        </div>
        <div class="tab-pane fade" id="contact-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
            <div class=" m-5">
                <table class="table table-striped table-sm">
                    <thead>
                        <tr>
                            <th scope="col">Tên tài khoản</th>
                            <th scope="col">Mật khẩu</th>
                            <th scope="col">Địa chỉ</th>
                            <th scope="col">Email</th>
                            <th scope="col">Họ tên</th>
                            <th scope="col">Số điện thoại</th>
                            <th scope="col">Chứa năng</th>
                        </tr>
                    </thead>
                    <tbody>

                        <tr *ngFor="let item of users ">
                            <td width="10%">{{item.username}}</td>
                            <td width="10%">{{item.password}}</td>
                            <td width="10%">{{item.address}}</td>
                            <td width="10%">{{item.email}}</td>
                            <td width="20%">{{item.fullName}}</td>
                            <td width="10%">{{item.phoneNumber}}</td>
                            <td width="10%" >{{item.role?'Quản lý':'Người dùng'}}</td>
                            <td width="10%"><button class="btn" (click)="editUser(item)" >Chỉnh sửa</button></td>
                            <td width="10%"><button class="btn btn-danger"
                                    (click)="RemoveUser(item.username)">Xóa</button></td>

                        </tr>
                    </tbody>
                </table>
            </div>


        </div>


    </div>